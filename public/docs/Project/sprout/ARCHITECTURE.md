# 🌱 Sprout 프로젝트 구조 및 동작 가이드

이 문서는 Sprout 앱이 **어떻게 시작되고**, **어떤 순서로 동작하며**, **Firebase와 어떻게 데이터를 주고받는지** 초보 개발자가 이해하기 쉽게 설명합니다.

---

## 1. 앱의 시작과 끝 (전체 흐름)

앱을 실행하면 다음과 같은 순서로 코드가 실행됩니다.

1.  **`index.ts` (진입점)**: 앱의 대문입니다. 여기서 `App.tsx`를 실행하라고 명령합니다.
2.  **`App.tsx` (최상위 컴포넌트)**: 앱의 뼈대입니다. 화면 이동을 담당하는 네비게이션을 준비합니다.
3.  **`LoginScreen` (첫 화면)**: 사용자가 처음 보는 화면입니다. 로그인을 시도합니다.
4.  **`MainNavigator` (메인 화면)**: 로그인 성공 시 진입하는 하단 탭 화면입니다. (홈, 식물관리, 프로필)

---

## 2. 파일별 상세 동작 설명

### 2.1 `index.ts` (앱의 시작점)
*   **역할**: React Native 앱을 운영체제(Android/iOS)에 등록하는 역할입니다.
*   **동작**: `registerRootComponent(App)` 함수가 호출되면서 `App.tsx` 컴포넌트를 앱의 루트(Root)로 설정합니다. Expo가 내부적으로 가장 먼저 찾는 파일입니다.

### 2.2 `App.tsx` (네비게이션 컨테이너)
*   **역할**: 앱 전체의 화면 이동(Navigation)을 관리하는 관리자입니다.
*   **구조**:
    *   `NavigationContainer`: 네비게이션 기능의 최상위 껍데기입니다.
    *   `Stack.Navigator`: 화면을 카드처럼 쌓아서 보여주는 방식입니다.
*   **흐름**:
    1.  앱이 켜지면 `LoginScreen`을 가장 먼저 보여줍니다 (`initialRouteName="Login"`).
    2.  로그인이 성공하면 `Main`이라는 이름의 `MainNavigator` 화면으로 교체해줍니다.

### 2.3 `LoginScreen.tsx` (로그인 화면)
*   **역할**: 사용자 인증을 처리합니다.
*   **Firebase 연동**:
    *   사용자가 이메일/비번 입력 -> `signInWithEmail` 함수 호출 -> Firebase 서버에 "이 사람 맞아?" 물어봄.
    *   맞다고 하면 `navigation.reset`을 통해 `Main` 화면으로 이동시킵니다. (뒤로가기 눌러도 로그인 화면으로 못 오게 아예 교체)

### 2.4 `MainNavigator.tsx` (메인 탭 화면)
*   **역할**: 로그인 후 보여지는 **하단 탭(Bottom Tab)** 구조를 만듭니다.
*   **구성**:
    1.  🏠 **홈**: 대시보드 (현재 준비 중)
    2.  🌿 **식물 관리**: 내 식물 등록/수정 (`PlantManageScreen`)
    3.  👤 **프로필**: 내 정보 수정 (`ProfileScreen`)

---

## 3. Firebase 연동 원리 (`firebaseApp.ts`)

### 3.1 싱글톤(Singleton) 패턴이란?
`firebaseApp.ts`는 앱 어디서든 **"똑같은 하나의 Firebase 연결"**만 쓰도록 보장하는 파일입니다.
*   **왜 썼나요?**: 데이터베이스 연결을 페이지마다 새로 만들면 폰이 느려지고 배터리가 빨리 닳습니다. 한 번 연결해둔 걸 계속 재사용하기 위함입니다.
*   **코드의 역할**:
    *   `getApp()`: 이미 연결된 게 있으면 그거 가져와!
    *   `initializeApp()`: 없으면 새로 연결해!
    *   이렇게 해서 `db`(데이터베이스), `auth`(로그인), `storage`(파일) 도구를 딱 하나씩만 만들어서 수출(`export`)합니다.

### 3.2 Firebase 도구 설명 (초보자용)
이 프로젝트에서 사용하는 Firebase 도구 3대장입니다.

1.  **Auth (인증)**: "문지기"
    *   로그인, 회원가입, 로그아웃을 담당합니다. 누가 누군지 식별합니다.
2.  **Firestore (데이터베이스)**: "엑셀 표"
    *   글자 데이터를 저장합니다. (닉네임, 식물 이름, 물 준 날짜 등)
    *   NoSQL이라서 엑셀보다는 'JSON 문서'를 폴더에 정리하는 느낌입니다.
3.  **Storage (저장소)**: "하드디스크"
    *   사진 파일을 저장합니다. (프로필 사진, 식물 사진)
    *   사진을 업로드하면 다운로드할 수 있는 인터넷 주소(URL)를 줍니다. 이 주소를 Firestore에 저장합니다.

---

## 4. 서비스(Service) 모듈화 구조

화면 그리는 코드(`Screen`)와 데이터 처리 코드(`Service`)를 분리했습니다. (이유: 코드가 섞이면 나중에 고치기 힘듦)

### 4.1 `userService.ts` (사용자 담당)
*   **하는 일**: 사용자 프로필을 읽고(`getUserProfile`), 쓰고(`updateUserProfile`), 사진 올리기(`uploadProfileImage`)
*   **장점**: "프로필 화면"은 "데이터가 어떻게 저장되는지" 몰라도 됩니다. 그냥 "저장해줘"라고 서비스에 부탁만 하면 됩니다.

### 4.2 `plantService.ts` (식물 담당)
*   **하는 일**: 식물 추가하기(`addPlant`), 방(Room) 정보 확인하기(`getOrCreateRoom`)
*   **똑똑한 기능**: 식물을 등록할 때 입력한 '거실'이라는 방이 없으면 자동으로 방을 먼저 만들고 식물을 등록합니다. 이런 복잡한 순서를 서비스가 알아서 처리해줍니다.

---

## 5. 설정 파일 약식 설명 (Root)

프로젝트의 가장 바깥에 있는 파일들이 하는 일입니다.

*   **`app.config.js`**: Expo 앱 설정 파일입니다. 앱 이름, 아이콘 경로, **Firebase 비밀키(API Key)** 등을 여기서 설정합니다.
*   **`package.json`**: "이 프로젝트의 준비물 목록"입니다. 어떤 라이브러리가 필요한지 적혀있습니다.
*   **`tsconfig.json`**: TypeScript 설정 파일입니다. 자바스크립트 문법 검사를 얼마나 깐깐하게 할지 정합니다.
*   **`babel.config.js`**: 코드를 번역해주는 설정입니다. 최신 코드를 구형 폰에서도 돌아가게 바꿔줍니다.

---

## 요약: 데이터 흐름 예시 (식물 등록)

1.  사용자가 **식물 관리 화면**(`PlantManageScreen`)에서 사진을 찍고 '저장'을 누릅니다.
2.  화면은 **`plantService.ts`**에게 "이 사진이랑 정보 좀 저장해줘"라고 부탁합니다.
3.  서비스는 먼저 **Firebase Storage**에 사진을 올리고 주소(URL)를 받습니다.
4.  그다음 **Firestore**에 식물 이름, 방 이름, 사진 주소를 예쁘게 포장해서 저장합니다.
5.  저장이 끝나면 다시 화면에게 "다 됐어!"라고 알려줍니다.
6.  화면은 사용자에게 "저장 완료!" 알림창을 띄웁니다.

